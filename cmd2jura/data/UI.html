<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta charset="UTF-8">
		<style>
			*{ 
				box-sizing:border-box;
			} 
			input, #quickcommand, textarea{
				border:1px solid #444;
				padding:16px;
			}
			label{
				padding: 5px;
				overflow:hidden;
				display:block;
			}
			input, #quickcommand, label, details, textarea{
				margin:0.5rem 0;
				width:100%;
				border-radius:6px;
				font-size:1.2rem;
			}
			input[type=submit]{
				cursor:pointer;
			}
			input[type=radio]{
				display:none;
			}
			input[type=radio]+label {
				font-weight: normal;
			}
			input[type=radio]:checked+label {
				font-weight: bold;
				background-color:rgb(239, 239, 239);
				border: 1px solid #444;
			}
			#log{
				width:100%;
				font-size:0.75rem;
				font-family:monospace;
				height:10em;
			}
			body {
				padding: 0 1rem;  
				color: #222;  
				background: #fff;  
				font: 100% system-ui;
			}
			@media (prefers-color-scheme: dark) {
				body, *{
					color: rgb(201, 209, 217);
					background: #010409;  
				}
				#quickcommand, #quickcommand summary, label{
					background-color:rgb(33, 38, 45);
				}
				input[type=submit]{
					background-color:rgb(33, 38, 45);
				}
				input[type=submit]:hover{
					background-color:rgb(40, 46, 51);
					border-color:rgb(110, 118, 129);
				}
				input[type=radio]:checked+label {
					background-color:rgb(40, 46, 51);
					border-color:rgb(110, 118, 129);
				}
			}
		</style>
	</head>
	<body>
		<h1>&#9749; Jura Impressa C5</h1>
			<form onsubmit="return s(this)" onChange="m(this)">
				<details id="quickcommand" size="7"  open>
					<summary>quick commands</summary>
					<input type="radio" value="AN:01" name="radios" id="poweron">
					<label for="poweron">ðŸŸ¢â €â €â €Power on </label>
					<input type="radio" value="FA:04" name="radios" id="fn1">
					<label for="fn1">â˜•â €â €â €Espresso </label>
					<input type="radio" value="FA:05" name="radios" id="fn2">
					<label for="fn2">â˜•â˜•â €Espresso </label>
					<input type="radio" value="FA:06" name="radios" id="fn3">
					<label for="fn3">â˜•â €â €â €Coffee </label>
					<input type="radio" value="FA:07" name="radios" id="fn4">
					<label for="fn4">â˜•â˜•â €Coffee</label>
					<input type="radio" value="TY:" name="radios" id="info">
					<label for="info">ðŸ›ˆâ €â €â €â €Get Type of Machine </label>
					<input type="radio" value="AN:02" name="radios" id="poweroff">
					<label for="poweroff">â­•â €â €â €Power off</label>
				</details>
				<details>
					<summary>type in manual command</summary>
					<input type="text" id="command"></input>
				</details>
				<input type="submit">
		</form>
		<details><summary>response log</summary><textarea id="log"></textarea></details>
		<script>
			//Cycle through Radio buttons and copy selected value to command input
			function m(f) {
					for (const rb of f.radios) {
					if (rb.checked) {
						this.command.value = rb.value;
						break;
					}
				}
			}
			function s(f) {
				var x = new XMLHttpRequest();
				x.open('POST', '/api', true);
				x.onreadystatechange = function() {
					//Also show errors
					if (x.readyState === XMLHttpRequest.DONE) {
						var r = document.getElementById('log');
						log.value = new Date().toLocaleTimeString() + ' - ' + f.command.value + ' - ' +  x.responseText + '\r\n' + log.value;
					}
				};
				x.send(f.command.value);
				return false;
			}
		</script>
	</body>
</html>